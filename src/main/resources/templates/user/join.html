<!DOCTYPE html>
<html xmlns:sec="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="description" content="" />
  <meta name="author" content="" />
  <title>Ya ho</title>
  <!-- Favicon-->
  <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
  <!-- Core theme CSS (includes Bootstrap)-->
  <link href="css/index.css" rel="stylesheet" />
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
</head>
<body>
<!-- Responsive navbar-->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container">
    <strong><a class="navbar-brand" href="/">우리 아이를 부탁해</a></strong>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item"><a class="nav-link active" aria-current="page" href="/">홈</a></li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" id="navbarDropdown" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">게시판</a>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
            <li><a class="dropdown-item" href="/cctvstream">실시간 CCT</a></li>
            <li><a class="dropdown-item" href="/recording">녹화 영상</a></li>
            <li><a class="dropdown-item" href="/list">자유게시판</a></li>
          </ul>
        </li>
        <li class="nav-item"><a class="nav-link active" aria-current="page" sec:authorize="isAnonymous()" th:href="@{/login}">로그인</a></li>
        <li class="nav-item"><a class="nav-link active" aria-current="page" sec:authorize="isAuthenticated()" th:href="@{/user/logout}">로그아웃</a></li>
        <li class="nav-item"><a class="nav-link active" aria-current="page" sec:authorize="isAnonymous()" th:href="@{/join}">회원가입</a></li>
        <li class="nav-item"><a class="nav-link active" aria-current="page" sec:authorize="hasRole('ROLE_MEMBER')" th:href="@{/user/info}">내정보</a></li>
      </ul>
    </div>
  </div>
</nav>
<!--signup-->

<div class="container" style="padding-top: 3%;">
  <div id="formDiv" style="padding-left: 25%; padding-right: 25%; padding-bottom: 5%;">
    <h2 style="margin-bottom: 1em">회원가입</h2>
    <form name="signupForm" th:action="@{/join}"  method="post">
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

      <label for="email">이메일</label>
      <input type="email" class="form-control" id="email" name="email" placeholder="이메일을 입력해주세요">

      <label for="userName" style="margin-top: 1.2em;">닉네임</label>
      <input type="text" class="form-control" id="userName" name="userName" placeholder="닉네임을 입력해주세요">

      <label for="password" style="margin-top: 1.2em;">비밀번호</label>
      <input type="password" class="form-control" id="password" name="password"
             placeholder="8자 이상 20자 이하로 작성해주세요.">

      <label for="passwordConfirm" style="margin-top: 1.2em; ">비밀번호 확인</label><br>
      <div style="float: left; width: 70%">
        <input type="password" class="form-control" id="passwordConfirm" name="passwordConfirm"
               placeholder="비밀번호를 다시 입력해주세요">
      </div>
      <div style="float: right;">
        <button type="button" class="btn btn-outline-danger" onclick="validationPw()">비밀번호 확인</button>
      </div>
      <button type="submit" id="signUpBtn" class="btn btn-success pull-right"
              style="margin-top: 1.5em; float: left" onclick="welcome()" disabled
               >회원가입</button>
      <a href="/login"><button type="button" class="btn btn-secondary pull-right"
                               style="margin-left: 1em; margin-top: 1.5em;">로그인</button></a>
    </form>
  </div>
</div>

</div>
</div>
</div>

<script type="text/javascript">

  let validationComponents = [false, false, false];

  $(document).ready(function () {
    $('#userName').on('blur', function () {
      let userName = document.getElementById('userName').value;
      if(userName.length>0) {
        $(this).css("background-color","#E3ECFE");
        validationComponents[1] = true;
      }
    });
  });

  $(document).ready(function() {
    $('#password').on('blur', function () {
      let password = $(this).val();
      if(password.length>0 && password.length<8) {
        alert("비밀번호가 너무 짧습니다.");
        $('#password').val('');
      }
      if(password.length>0 && password.length>=8 && password.length<=20) {
        $(this).css("background-color","#E3ECFE");
      }
    });
  });

  function validationPw() {
    let password = $('#password').val();
    let passwordConfirm = $('#passwordConfirm').val();

    if(password!==passwordConfirm) {
      alert("비밀번호가 일치하지 않습니다.");
      document.getElementById('password').innerText='';
      document.getElementById('passwordConfirm').innerText='';
    }

    if(password===passwordConfirm) {
      validationComponents[2] = true;
      $('#passwordConfirm').css("background-color","#E3ECFE");
      alert("사용가능한 비밀번호입니다.");
    }

    if(validationComponents[0]===false && validationComponents[1]===true && validationComponents[2]===true) {
      $('#signUpBtn').attr("disabled", false);
    }
  }

  function welcome() {
    alert("회원가입을 환영합니다!");
  }

</script>


<!-- Footer-->
<footer class="py-5 bg-dark">
  <div class="container px-4 px-lg-5"><p class="m-0 text-center text-white">My Website 2021</p></div>
</footer>
<!-- Bootstrap core JS-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
<!-- Core theme JS-->
<script src="js/scripts.js"></script>

</body>
</html>
